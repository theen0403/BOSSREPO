@model BOSS.Models.BPmodels.AIPmodels.PPAperOfficeModel
@{
    BOSSEFConnectionString BOSSDB = new BOSSEFConnectionString();
}
@using BOSS.Models;
<script>
    $("#PreparationPerOfficeID").addClass("active");
</script>

@*Header*@
<div class="content-header row">
    <div class="content-header-left col-md-6 col-12 mb-0">
        <h3 class="content-header-title"><strong>Program/Project/Activities</strong></h3>
    </div>
</div>

@*BODY*@
<div class="content-body">
    <div class="row">
        <div class="content-header-left col-md-12">
            <div class="card box-shadow-2">
                <div class="card-content collapse show">
                    <div class="card-body rounded" style="border: 1px solid; border-color: #9BC69D;">
                        <div class="row mt-0">
                            <div class="col-xl-1"></div>
                            <div class="col-xl-2 col-lg-3 col-md-3">
                                <div class="form-group">
                                    <label>Budget Year</label>
                                    @Html.DropDownListFor(model => model.PPAperOfficeList.Year,
                                    Enumerable.Range(2018, DateTime.Now.AddYears(2).Year - 2018).
                                    Select(i => new SelectListItem { Value = i.ToString(), Text = i.ToString() }),
                                    new { @class = "form-control" })
                                </div>
                            </div>
                            <div class="col-xl-6 col-lg-6 col-md-6">
                                <div class="form-group">
                                    <label>Responsibility Center</label>
                                    @Html.DropDownListFor(m => m.PPAperOfficeList.DeptID, Model.DeptList, new { @class = "form-control select2 deptID", id = "" })
                                </div>
                            </div>
                            <div class="col-md-3 col-sm-4 mt-xl-1 mt-lg-1 mt-md-1">
                                <button type="button" class="btn btn-btnbackcolor btn-min-width button mt-1"
                                        data-toggle="modal"
                                        data-target="#ViewPrintPreviewModal"
                                        onclick="OpenViewUpdatePrintPreviewModal()">
                                    Preview
                                </button>
                            </div>
                        </div>
                        @*LIST OF PROGRAMS*@
                        <div class="card box-shadow-2 m-0 p-0">
                            <div class="card-header bg-active mt-1">
                                <h4 class="card-title black">Sector: General Services</h4>
                                <a class="heading-elements-toggle"><i class="la la-ellipsis-v font-medium-3"></i></a>
                                <div class="heading-elements mt-0">
                                    <ul class="list-inline mb-0">
                                        <li><a data-action="collapse"><i class="ft-minus black"></i></a></li>
                                    </ul>
                                </div>
                            </div>
                            <div class="card-content collapse show">
                                <div id="tempindexprogramid"></div>
                            </div>
                            </div>
                        @*LIST OF PROJECTS*@
                        <div class="card box-shadow-2 m-0 p-0">
                            <div class="card-header bg-active mt-1">
                                <h4 class="card-title black">List Of Projects for:</h4>
                                <a class="heading-elements-toggle"><i class="la la-ellipsis-v font-medium-3"></i></a>
                                <div class="heading-elements mt-0">
                                    <ul class="list-inline mb-0">
                                        <li><a data-action="collapse"><i class="ft-plus black"></i></a></li>
                                    </ul>
                                </div>
                            </div>
                            <div class="card-content collapse">
                                <div class="card-body px-1 card-body rounded box-shadow-3">
                                    <div class="col-md-4 p-0">
                                        <button type="button" class="btn btn-btnbackcolor btn-min-width mb-1"
                                                onclick="AngularGlobalView('PerOfficeController','GetViewAddProject','  1 ')">
                                            Add Project
                                        </button>
                                    </div>
                                    <div class="row m-0" ng-bind-html="ProjectListID">

                                    </div>
                                </div>
                                <div class="card-header bg-active rounded">
                                    <div class="row">
                                        <div class="col-lg-4 col-md-4 col-sm-4"></div>
                                        <div class=" col-lg-4 col-md-4 col-sm-4">
                                            <h4 class="card-title black pull-right">TOTAL COST(All Project):</h4>
                                        </div>
                                        <div class="col-lg-3 col-md-3 col-sm-3">
                                            <h4 class="card-title text-right pr-1 black">140,715,000.00</h4>
                                        </div>
                                        <div class="col-lg-1 col-md-1 col-sm-1"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        @*LIST OF ACTIVITIES*@
                        <div class="card box-shadow-2 m-0 p-0">
                            <div class="card-header bg-active mt-1">
                                <h4 class="card-title black">List of Activities for:</h4>
                                <a class="heading-elements-toggle"><i class="la la-ellipsis-v font-medium-3"></i></a>
                                <div class="heading-elements mt-0">
                                    <ul class="list-inline mb-0">
                                        <li><a data-action="collapse"><i class="ft-plus black"></i></a></li>
                                    </ul>
                                </div>
                            </div>
                            <div class="card-content collapse">
                                <div class="card-body px-1 card-body rounded box-shadow-3">
                                    <div class="col-md-4 p-0">
                                        <button type="button" class="btn btn-btnbackcolor btn-min-width mb-1"
                                                onclick="AngularGlobalView('PerOfficeController','GetViewAddActivity','  1 ')">
                                            Add Activity
                                        </button>
                                    </div>
                                    <div class="row m-0" ng-bind-html="ActivityListID">

                                    </div>
                                </div>
                                <div class="card-header bg-active rounded">
                                    <div class="row">
                                        <div class="col-lg-4 col-md-4 col-sm-4"></div>
                                        <div class=" col-lg-4 col-md-4 col-sm-4">
                                            <h4 class="card-title black pull-right">TOTAL COST(All Activities):</h4>
                                        </div>
                                        <div class="col-lg-3 col-md-3 col-sm-3">
                                            <h4 class="card-title text-right pr-1 black">12,527,000.00</h4>
                                        </div>
                                        <div class="col-lg-1 col-md-1 col-sm-1"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
    @*============================================   MODAL   =============================================*@
    @*PROGRAM*@
    @*ADD Program*@
    <div class="modal fade text-left" id="ViewAddProgramModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel2"
         aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header bg-active">
                    <h4 class="modal-title black" id="myModalLabel2">Program Details</h4>
                </div>
                <div class="modal-body skin skin-square">
                    <div class="row" id="ViewAddProgram">

                    </div>
                </div>
                <div class="modal-footer m-0 p-1">
                    @{
                        <button type="button" class="btn bg-active btn-min-width black" onclick="" data-dismiss="modal">Add</button>
                    }
                    <button type="button" class="btn bg-danger btn-min-width white" data-dismiss="modal">Cancel</button>
                </div>
            </div>
        </div>
    </div>
    @*ViewEdit Program*@
    <div class="modal fade text-left" id="ViewEditProgramModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel2"
         aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header bg-active">
                    <h4 class="modal-title black" id="myModalLabel2">Program Details</h4>
                </div>
                <div class="modal-body skin skin-square">
                    <div class="row" id="ViewEditProgram">

                    </div>
                </div>
                <div class="modal-footer m-0 p-1">
                    @{
                        var ConfirmationEditMess = "Are you sure you want to update?";
                        var ProgramTitle = "Program, \"Executive Governance\" (1000-1) was successfully updated in the 2018 List of P/P/As.";
                        var SuccesEditMess = "Program Successfully Updated!!";
                        <button class="btn bg-active btn-min-width black"
                                onclick="swalConfirmation('@ConfirmationEditMess',' @ProgramTitle ' ,'@SuccesEditMess ' )" data-dismiss="modal">
                            Update
                        </button>
                    }
                    <button type="button" class="btn bg-danger btn-min-width white" data-dismiss="modal">Cancel</button>
                </div>
            </div>
        </div>
    </div>
    @*PROJECT*@
    @*View Add Project*@
    <div class="modal fade text-left" id="ViewAddProjectModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel2"
         aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header bg-active">
                    <h4 class="modal-title black" id="myModalLabel2">Project Details</h4>
                </div>
                <div class="modal-body skin skin-square">
                    <div class="row" ng-bind-html="ViewAddProject">

                    </div>
                </div>

                <div class="modal-footer m-0 p-1">
                    @{
                        var SuccessMess = "Added Successfully!";
                        <button type="button" class="btn bg-active btn-min-width black" onclick="swalSuccess('@SuccessMess')" data-dismiss="modal">Add</button>
                    }
                    <button type="button" class="btn bg-danger btn-min-width black" data-dismiss="modal">Cancel</button>
                </div>
            </div>
        </div>
    </div>
    @*View Edit Project*@
    <div class="modal fade text-left" id="ViewEditProjectModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel2"
         aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header bg-active">
                    <h4 class="modal-title black" id="myModalLabel2">Project Details</h4>
                </div>
                <div class="modal-body skin skin-square">
                    <div class="row" ng-bind-html="ViewEditProject">

                    </div>
                </div>
                <div class="modal-footer m-0 p-1">
                    @{
                        var ProgramTitle2 = "Project, \"Purchase of Helicopter\" (1000-1-1) was successfully updated in the 2018 List of P/P/As.";
                        var SuccesEditMess2 = "Project Successfully Updated!!";
                        

                        <button class="btn bg-active btn-min-width black"
                                onclick="swalConfirmation('@ConfirmationEditMess',' @ProgramTitle2 ' ,'@SuccesEditMess2 ' )" data-dismiss="modal">
                            Update
                        </button>
                    }
                    <button type="button" class="btn bg-danger btn-min-width white" data-dismiss="modal">Cancel</button>
                </div>
            </div>
        </div>
    </div>

    @*ACTIVITY*@
    @*View Add Activity*@
    <div class="modal fade text-left" id="ViewAddActivityModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel2"
         aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header bg-active">
                    <h4 class="modal-title black" id="myModalLabel2">Activity Details</h4>
                </div>
                <div class="modal-body skin skin-square">
                    <div class="row" ng-bind-html="ViewAddActivity">

                    </div>
                </div>
                <div class="modal-footer m-0 p-1">
                    @{
                        <button type="button" class="btn bg-active btn-min-width black" onclick="swalSuccess('@SuccessMess')" data-dismiss="modal">Add</button>
                    }
                    <button type="button" class="btn bg-danger btn-min-width white" data-dismiss="modal">Cancel</button>
                </div>
            </div>
        </div>
    </div>
    @*View Edit Activity*@
    <div class="modal fade text-left" id="ViewEditActivityModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel2"
         aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header bg-active">
                    <h4 class="modal-title black" id="myModalLabel2">Activity Details</h4>
                </div>
                <div class="modal-body skin skin-square">
                    <div class="row" ng-bind-html="ViewEditActivity">

                    </div>
                </div>
                <div class="modal-footer m-0 p-1">
                    @{
                        var ProgramTitle3 = "Project, \"Purchase of Helicopter\"(1000 - 1 - 1 - 2) was successfully updated in the 2018 List of P / P / As.";
                        var SuccesEditMess3 = "Activity Succesfully Updated!!";
                        <button class="btn bg-active btn-min-width black"
                                onclick="swalConfirmation('@ConfirmationEditMess',' @ProgramTitle3 ' ,'@SuccesEditMess3 ' )" data-dismiss="modal">
                            Update
                        </button>
                    }
                    <button type="button" class="btn bg-danger btn-min-width white" data-dismiss="modal">Cancel</button>
                </div>
            </div>
        </div>
    </div>
    @*View Attachments*@
    <div class="modal animated zoomIn text-left" id="ViewAttachmentModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel2"
         aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header bg-active">
                    <p class="modal-title black" id="myModalLabel2">Attachments(Note: Accepted file types: *.doc, *.rar, *.zip, *.xls, and*.xlsx) :</p>
                </div>
                <div class="modal-body skin skin-square">
                    <div class="row" ng-bind-html="ViewAttachment">

                    </div>
                </div>
                <div class="modal-footer m-0 p-1">
                    <button type="button" class="btn bg-danger btn-min-width white" data-dismiss="modal">Cancel</button>
                </div>
            </div>
        </div>
    </div>
    @*View Add Attachment*@
    <div class="modal animated zoomIn text-left" id="ViewAddAttachmentModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel2"
         aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header bg-active">
                    <p class="modal-title black" id="myModalLabel2">Attachments(Note: Accepted file types: *.doc, *.rar, *.zip, *.xls, and*.xlsx) :</p>
                </div>
                <div class="modal-body skin skin-square">
                    <div class="row" ng-bind-html="ViewAddAttachment">

                    </div>
                </div>
                <div class="modal-footer m-0 p-1">
                    @{
                        <button type="button" class="btn bg-active btn-min-width black" data-toggle="modal" data-target="" onclick="">Add</button>
                    }
                    <button type="button" class="btn bg-danger btn-min-width white" data-dismiss="modal">Cancel</button>
                </div>
            </div>
        </div>
    </div>
    @*Print Preview*@
    <div class="modal fade text-left" id="ViewPrintPreviewModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel2"
         aria-hidden="true">
        <div class="modal-dialog modal-sm" role="document">
            <div class="modal-content">
                <div class="modal-header bg-active">
                    <h4 class="modal-title black" id="myModalLabel2">Print Preview Options</h4>
                </div>
                <div class="modal-body m-0" id="ViewPrintPreview">


                </div>
                <div class="modal-footer m-0 p-1">
                    @{
                        <a class="btn bg-active2 btn-min-width black button"
                           data-caption="01/01/19" href="~/Resources/PDF/blank.pdf"
                           target='_blank' onclick="CloseModal()">
                            Ok
                        </a>
                    }
                    <button type="button" class="btn bg-danger btn-min-width white" data-dismiss="modal">Cancel</button>
                </div>
            </div>
        </div>
    </div>

    @*JS==========================================================================================*@
    <script>
        app.controller('PerOfficeController', function ($scope, $http, $sce) {
            var F = $scope, P = $http, D = $sce.trustAsHtml;

            //=========================PROGRAM TABLE =========================
            //Get PROGRAM Datatable Partial View
            //F.GetProgramlistDTable = function () {
            //    F.ProgramListID = null;
            //    P({
            //        url: '/PreparationPerOffice/GetProgramlistDTable',
            //    }).then(function (response) {
            //        F.ProgramListID = D(response.data);
            //    });
            //}
            ////Get Add PROGRAM Modal Partial View
            //F.GetViewAddProgram = function (ID) {
            //    P({
            //        url: '/PreparationPerOffice/GetViewAddProgram',
            //        params: { ID: ID }
            //    }).then(function (response) {
            //        F.ViewAddProgram = D(response.data);
            //        $('#ViewAddProgramModal').modal('toggle');
            //    });
            //}
            //Get Edit/View PROGRAM Modal Partial View
            F.GetViewEditProgram = function (ID) {
                P({
                    url: '/PreparationPerOffice/GetViewEditProgram',
                    params: { ID: ID }
                }).then(function (response) {
                    F.ViewEditProgram = D(response.data);
                    $('#ViewEditProgramModal').modal('toggle');
                });
            }
            //=========================PROJECT TABLE =========================
            //Get Datatable PROJECT Partial View
            F.GetProjectlistDTable = function () {
                F.ProjectListID = null;
                P({
                    url: '/PreparationPerOffice/GetProjectlistDTable',
                }).then(function (response) {
                    F.ProjectListID = D(response.data);
                });
            }
            //Get Add PROJECT Modal Partial View
            F.GetViewAddProject = function (ID) {
                P({
                    url: '/PreparationPerOffice/GetViewAddProject',
                    params: { ID: ID }
                }).then(function (response) {
                    F.ViewAddProject = D(response.data);
                    $('#ViewAddProjectModal').modal('toggle');
                });
            }
            //Get Edit/View PROJECT Modal Partial View
            F.GetViewEditProject = function (ID) {
                P({
                    url: '/PreparationPerOffice/GetViewEditProject',
                    params: { ID: ID }
                }).then(function (response) {
                    F.ViewEditProject = D(response.data);
                    $('#ViewEditProjectModal').modal('toggle');
                });
            }
            //=========================ACTIVITY TABLE =========================
            //Get Datatable ACTIVITY Partial View
            F.GetActivitylistDTable = function () {
                F.ActivityListID = null;
                P({
                    url: '/PreparationPerOffice/GetActivitylistDTable',
                }).then(function (response) {
                    F.ActivityListID = D(response.data);
                });
            }
            //Get Add ACTIVITY Modal Partial View
            F.GetViewAddActivity = function (ID) {
                P({
                    url: '/PreparationPerOffice/GetViewAddActivity',
                    params: { ID: ID }
                }).then(function (response) {
                    F.ViewAddActivity = D(response.data);
                    $('#ViewAddActivityModal').modal('toggle');
                });
            }
            //Get Edit/View ACTIVITY Modal Partial View
            F.GetViewEditActivity = function (ID) {
                P({
                    url: '/PreparationPerOffice/GetViewEditActivity',
                    params: { ID: ID }
                }).then(function (response) {
                    F.ViewEditActivity = D(response.data);
                    $('#ViewEditActivityModal').modal('toggle');
                });
            }
            //Get Add Attachment ACTIVITY Modal Partial View
            F.GetViewAddAttachment = function (ID) {
                P({
                    url: '/PreparationPerOffice/GetViewAddAttachment',
                    params: { ID: ID }
                }).then(function (response) {
                    F.ViewAddAttachment = D(response.data);
                    $('#ViewAddAttachmentModal').modal('toggle');
                });
            }
            //Get View Attachment ACTIVITY Modal Partial View
            F.GetviewAttachment = function (ID) {
                P({
                    url: '/PreparationPerOffice/GetViewAttachment',
                    params: { ID: ID }
                }).then(function (response) {
                    F.ViewAttachment = D(response.data);
                    $('#ViewAttachmentModal').modal('toggle');
                });
            }
        });
    </script>